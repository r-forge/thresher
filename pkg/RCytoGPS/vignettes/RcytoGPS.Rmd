---
title: "Graphing Cytoband Data with RCytoGPS"
author: "Kevin R. Coombes"
date: "`r Sys.Date()`"
output:
  rmarkdown::html_document:
    theme: journal
    highlight: kate
vignette: >
  %\VignetteIndexEntry{Graphing Tools in RCytoGPS}
  %\VignetteKeywords{OOMPA,CytoGPS,karyotypes,idiograms,graphics}
  %\VignetteDepends{RCytoGPS}
  %\VignettePackage{RCytoGPS}
  %\VignetteEngine{knitr::rmarkdown}
---

```{r opts, echo=FALSE}
knitr::opts_chunk$set(fig.width=8, fig.height=5)
```
# Introduction
In this vignette, we focus on the different visualizations you can generate by
changing the arguments for the `image` and `barplot` methods. The main arguments
to `image`, when using a `CytobandData` object from the package are

* `chr`: The chromsome to plot, which can take on the value `all` to show the whole genome
* `what`: A list or vector indicating which data columns to show.

To produce the figures in this gallery, we will use a dataset that comes with the
package, already processed,

```{r}
library(RCytoGPS)
data(cytoData)
ls()
colnames(cytoData)
```

```{r}
bandData <- CytobandData(cytoData)
class(bandData)
summary(bandData)
```

# Plotting Cytoband Data Along the Genome

```{r gb, fig.cap="Cytoband level data along the genome.", fig.width=10, fig.height=5}
opar <- par(mfrow=c(2,1))
barplot(bandData, "A.Loss", col = "forestgreen")
barplot(bandData, "B.Loss", col="orange")
par(opar)
```

# Single Chromosome Plots
Note: "Horizontal" and "vertical" refer to the direction of the chromosome with its cytoband shading.

## Plotting Cytoband-Level Data Along One Chromosome
```{r v.plot2Chrom, fig.width=8, fig.height=5,fig.cap = "Vertical stacked barplot of LGF frequencies on chromosome 3 for type A samples."}
Acolumns <- c("A.Loss", "A.Gain", "A.Fusion")
image(bandData, what = Acolumns, chr = 3)
```

```{r h.plot2Chrom, fig.width=5, fig.height=8, fig.cap = "Horizontal stacked barplot of LGF frequencies on chromosome 3 for type A samples."}
image(bandData, Acolumns, chr = 3, horiz = TRUE)
```

## Plotting Cytoband-Level Data Along Both Sides of One Chromosome
```{r v.plot1Chrom, fig.width=8, fig.height=5, fig.cap = "Vertical stacked barplot of LGF frequencies on chromosome 13 for type A and B samples."}
image(bandData, what = list("A.Loss", "B.Loss"), chr = 13)
```

```{r h.plot1Chrom, fig.width=5, fig.height=8, fig.cap = "Horizontal stacked barplot of LGF frequencies on chromosome 13 for type A and B samples."}
image(bandData, what = list("A.Loss", "B.Loss"), chr = 13, horiz = TRUE)
```

# Idiograms

## One Data Column
```{r makeid, fig.width=10, fig.height=8, fig.cap="Idiogram for one data columm."}
image(bandData, what = "A.Loss", chr = "all", pal = "orange")
```

## Contrasting Two Data Columns
```{r biid, fig.width=10, fig.height=8, fig.cap="Idiogram to contrast two data columms."}
image(bandData, what = list("A.Loss", "A.Gain"), chr = "all", 
      pal=c("orange", "forestgreen"))
```

```{r biid3, fig.width=10, fig.height=10, fig.cap="Idiogram to contrast two data columms."}
image(bandData, what = list("A.Loss", "A.Gain"), chr = "all", nrows = 3,
      pal=c("orange", "forestgreen"))
```

```{r hbiid, fig.width=8, fig.height=10, fig.cap="Idiogram to contrast two data columms."}
image(bandData, what = list("A.Loss", "A.Gain"), chr = "all", 
      pal=c("orange", "forestgreen"), horiz = TRUE)
```

## Many Data Columns
```{r stackid, fig.width=6, fig.height=14, fig.cap="Idiogram for many data columns."}
image(bandData, what = paste(LETTERS[1:3], "Loss", sep="."), chr = "all", 
              pal=c("forestgreen", "orange", "purple"), nrows=3, horiz = FALSE)
```

```{r hstackid, fig.width=14, fig.height=5, fig.cap="Idiogram for many data columns."}
image(bandData, what = paste(LETTERS[1:3], "Loss", sep="."), chr = "all", 
              pal=c("forestgreen", "orange", "purple"), nrows=3, horiz= TRUE)
```

# Appendix
```{r si}
sessionInfo()
```